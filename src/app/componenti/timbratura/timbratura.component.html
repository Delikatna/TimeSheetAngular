<div class="timbrature-wrapper">
  <!--
    Rimosso [linear]="true" per permettere il salto programmatico agli step successivi.
    Mantenuto [editable]="false" in ogni step per impedire la navigazione manuale.
  -->
  <mat-horizontal-stepper [selectedIndex]="stepCorrente" class="stepper" (selectionChange)="onStepChange($event)">
    <mat-step *ngFor="let label of stepLabels; let i = index" [completed]="stepCompleted(i)" [editable]="false">
      <ng-template matStepLabel>
        {{ label }}
      </ng-template>

      <!-- Il contenuto dello step (pulsante) viene mostrato solo se Ã¨ lo step correntemente attivo -->
      <div class="step-content" *ngIf="i === stepCorrente && !statoTimbratura.assenzaSegnata && stepCorrente < stepLabels.length">
        <button
          class="timbratura-btn" (click)="timbraStep()">
          TIMBRA {{ label | uppercase }}
        </button>
      </div>
    </mat-step>

    <!-- Step finale di riepilogo quando tutte le timbrature sono completate -->
    <mat-step [editable]="false">
        <ng-template matStepLabel>Completato</ng-template>
        <div class="step-content">
            <p class="testo-completato">Giornata lavorativa conclusa. Tutte le timbrature sono state effettuate.</p>
        </div>
    </mat-step>
  </mat-horizontal-stepper>

  <!-- Messaggio temporaneo per notifiche automatiche -->
  <div *ngIf="mostraMessaggioOrarioAuto" class="messaggio-orario-auto">
    {{ messaggioOrarioAuto }}
  </div>

  <!-- Pulsanti per azioni speciali come Straordinario e Assenza -->
  <div class="azioni-speciali-container">
     <button class="straordinario-btn" (click)="cliccaStraordinario()" [disabled]="statoTimbratura.entrataStraordinario">
       TIMBRA INGRESSO STRAORDINARIO
     </button>
     <button class="straordinario-btn" (click)="cliccaStraordinario()" [disabled]="statoTimbratura.uscitaStraordinario">
       TIMBRA USCITA STRAORDINARIO
     </button>
  </div>

</div>